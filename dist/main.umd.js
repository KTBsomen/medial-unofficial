!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Medial=t():e.Medial=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>o});const o=class{constructor(e){this.baseUrl="https://prod.medial.app/api",this.accessToken=e}_decodeJWT(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(o)}async _sendFormData(e){const t=`${this.baseUrl}/v2/post`,o={method:"POST",headers:{Accept:"application/json","Access-Token":this.accessToken,Connection:"Keep-Alive",Host:"prod.medial.app","User-Agent":"com.medial.android",VersionCode:"32",VersionName:"1.3.1"},body:e};try{const e=await fetch(t,o);return await e.json()}catch(e){throw console.error("Error:",e),e}}async _fetchImage(e){try{const t=await fetch(e),o=await t.blob(),r=e.split("/").pop();return new File([o],r,{type:o.type})}catch(e){throw console.error("Error fetching image:",e),e}}async _getImages(e){const t=[];for(const o of e)if("string"==typeof o){const e=await this._fetchImage(o);t.push(e)}else o instanceof File&&t.push(o);return t}getMyId(){return this._decodeJWT(this.accessToken).userId}async getPods(e=0,t=20){const o=`${this.baseUrl}/v1/pod?offset=${e}&limit=${t}`,r={method:"GET",headers:{Accept:"application/json","Accept-Charset":"UTF-8","Accept-Encoding":"gzip","Access-Token":this.accessToken,Connection:"Keep-Alive",Host:"prod.medial.app",origin:"chrome-extension://bhmdjpobkcdcompmlhiigoidknlgghfo","User-Agent":"com.medial.android",VersionCode:"32",VersionName:"1.3.1"}};try{const e=await fetch(o,r);if(!e.ok)throw new Error(`Failed to fetch pods: ${e.statusText}`);return(await e.json()).data}catch(e){throw console.error("Error fetching pods:",e),e}}async getPosts(e=0,t=20,o="trending"){const r=`${this.baseUrl}/v2/post?offset=${e}&limit=${t}&filter=${o}`,n={method:"GET",headers:{Accept:"application/json","Accept-Charset":"UTF-8","Accept-Encoding":"gzip","Access-Token":this.accessToken,Connection:"Keep-Alive",Host:"prod.medial.app","User-Agent":"com.medial.android",VersionCode:"32",VersionName:"1.3.1"}};try{const e=await fetch(r,n);if(!e.ok)throw new Error(`Failed to fetch posts: ${e.statusText}`);return await e.json()}catch(e){throw console.error("Error fetching posts:",e),e}}async sendPost({content:e,referenceType:t="POD",referenceId:o,creatorId:r,rootPostId:n="",creatorType:s="USER",images:c}){const a=new FormData,i={content:e,referenceType:t,referenceId:o,rootPostId:n,creator:{id:r||this.getMyId(),type:s},media:c&&c.length>0?{type:"IMAGE"}:null};return c&&c.length>0&&(sourceImage=await this._getImages(c),sourceImage.forEach(((e,t)=>{a.append(`postImages[${t}]`,e,e.name)}))),a.append("post",JSON.stringify(i)),this._sendFormData(a)}async sendComment({content:e,referenceId:t,rootPostId:o,creatorId:r,creatorType:n}){const s=new FormData,c={content:e,referenceType:"POST",referenceId:t,rootPostId:o,creator:{id:r||this.getMyId(),type:n}};return s.append("post",JSON.stringify(c)),this._sendFormData(s)}async sendPoll({content:e,referenceType:t="POD",referenceId:o,rootPostId:r="",creatorId:n,creatorType:s,question:c,options:a}){const i=new FormData,d=a.map((e=>({text:e.toString(),selectionCount:0}))),p={content:e,referenceType:t,referenceId:o,rootPostId:r,creator:{id:n||this.getMyId(),type:s},media:{type:"POLL",poll:{question:c,formattedOptions:d}}};return i.append("post",JSON.stringify(p)),this._sendFormData(i)}async sendLink({content:e,referenceType:t="POD",referenceId:o,rootPostId:r="",creatorId:n,creatorType:s,links:c}){const a=new FormData,i={content:e,referenceType:t,referenceId:o,rootPostId:r,creator:{id:n||this.getMyId(),type:s},media:{type:"LINK",links:c}};return a.append("post",JSON.stringify(i)),this._sendFormData(a)}async likePost({referenceId:e,referenceType:t="POST"}){const o=`${this.baseUrl}/v1/like`,r={method:"POST",headers:{Accept:"application/json","Access-Token":this.accessToken,"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({referenceId:e,referenceType:t})};try{const e=await fetch(o,r);return await e.json()}catch(e){throw console.error("Error:",e),e}}async getUser(e){const t=`${this.baseUrl}/v2/user/${e}`,o={method:"GET",headers:{Accept:"application/json","Access-Token":this.accessToken}};try{const e=await fetch(t,o);return await e.json()}catch(e){throw console.error("Error:",e),e}}async sendConversation({receiverId:e,text:t}){const o=`${this.baseUrl}/v1/conversation`,r={receiverId:e,text:t},n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Access-Token":this.accessToken},body:JSON.stringify(r)};try{const e=await fetch(o,n);return await e.json()}catch(e){throw console.error("Error:",e),e}}};return t.default})()));